{"noir_version":"1.0.0-beta.15+83245db91dcf63420ef4bcbbd85b98f397fee663","hash":"17121301342536691301","abi":{"parameters":[{"name":"p1","type":{"kind":"integer","sign":"unsigned","width":64},"visibility":"private"},{"name":"p2","type":{"kind":"integer","sign":"unsigned","width":64},"visibility":"private"},{"name":"p3","type":{"kind":"integer","sign":"unsigned","width":64},"visibility":"private"},{"name":"asset_id","type":{"kind":"field"},"visibility":"public"}],"return_type":{"abi_type":{"kind":"tuple","fields":[{"kind":"integer","sign":"unsigned","width":64},{"kind":"field"}]},"visibility":"public"},"error_types":{"361444214588792908":{"error_kind":"string","string":"attempt to multiply with overflow"},"1998584279744703196":{"error_kind":"string","string":"attempt to subtract with overflow"},"14990209321349310352":{"error_kind":"string","string":"attempt to add with overflow"}}},"bytecode":"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","debug_symbols":"tZfdauMwEIXfxde+0M9oJPVVlqW4qVsCJgluUlhK331nrCO3u5AQZHqT7yTOfFgaSYk/uufx6fL6uD+8HN+6h18f3dO8n6b96+N03A3n/fEgn3589l19+3iex1E+6r5dl6rTMI+Hc/dwuExT370P02X50ttpOCw8D7NcNX03Hp6FInzZT6Omz/6r2lwvzc6hOLu0lof762mtp6Z6Xuu5qT4x6q0x/pqArgsCEwSBc0t9rAMIMbbUp1jrs2uoZ/Ko52A31rc0wBqb1w54vmawZmMLbgru6cFNwT1NuCW4qwv3CtraENzahhuzyFvbwFvbwFvbwFvbwD/ZhlyHYKUPWw3WtRhsrj8I1pmrjXA3DgUbUjWwbxE4X+fR+dQi8Kbegbe+ZRIc2XUSrq+Fuw1Ni8HbdRq9C22GdTF4b5oMFFZDCFsN3LQgaf2TITG3GdZekKcmA60/UxTyVgM3be3g1j8rwfs2Q/gyNK3JaNZexP8Oh9/ybtjt53/+o3Zevtl3tLwG2bR9x8trlK3Zd2l5zSLoO2sKbIErkHoZtaWCUMAF4pD1bVOBWGS/OFMgFplv5wp8ARUEPeWEDEYwgVn3bN95A1rQgTomuW1PoPrkMPIMqk/u3ScwF5IB1Sd3TA70IIHqkzEQgxFMoPpkHMGA4nPStOBA8emCDwQGkMGo56pQfLogQi5kA1pQfTLP7EECA8hgBBOYC6MB1Sfjig70IIEBZDCCCYQvwZcsiPtL6pN5SAQGkEFdazIvKYG5MBvQ6s+E0IEeJDCADEZQfbp8c6E8QtSgRtLgavA1UA1qXZY91xBrSDVkBN0bJdga1KzLXndICVRDqEHNSUOsIdWQEXS/+KzB1uBq8DVQDaEGMZPRUO9ZN49OitXdo12zun2cHhHvw7wfnqYRz6wvl8Pu2yPs+c+pXqkPuaf5uBufL/OoR8lyTQ6Xvw==","file_map":{"50":{"source":"// Function to sort values in ascending order\nfn sort3(a: u64, b: u64, c: u64) -> [u64; 3] {\n    let mut x = a;\n    let mut y = b;\n    let mut z = c;\n\n    if x > y {\n        let tmp = x;\n        x = y;\n        y = tmp;\n    }\n\n    if y > z {\n        let tmp = y;\n        y = z;\n        z = tmp;\n    }\n\n    if x > y {\n        let tmp = x;\n        x = y;\n        y = tmp;\n    }\n\n    [x, y, z]\n}\n\n// Two prices are aligned if they are within 7% (hardcoded) of each other.\nfn are_close(p: u64, q: u64) -> bool {\n    assert(p > 0);\n    assert(q > 0);\n\n    let diff = if p > q { p - q } else { q - p };\n    let max  = if p > q { p } else { q };\n\n    diff * 7 <= max\n}\n\n// Main circuit:\n//  - p1, p2, p3: private feeds\n//  - asset_id: public (binds proof to an asset, e.g. TSLA)\n// Returns: public (final_price, asset_id)\nfn main(\n    p1: u64,\n    p2: u64,\n    p3: u64,\n    asset_id: pub Field,\n) -> pub (u64, Field) {\n    assert(p1 > 0);\n    assert(p2 > 0);\n    assert(p3 > 0);\n\n    let c12 = are_close(p1, p2);\n    let c13 = are_close(p1, p3);\n    let c23 = are_close(p2, p3);\n\n    let final_price = if c12 & c13 & c23 {\n        // Case 1: all three feeds agree (no outlier)\n        let sorted = sort3(p1, p2, p3);\n        sorted[1]\n    } else if c12 & !c13 & !c23 {\n        // Case 2: (p1, p2) aligned, p3 outlier\n        (p1 + p2) / 2\n    } else if c13 & !c12 & !c23 {\n        // Case 3: (p1, p3) aligned, p2 outlier\n        (p1 + p3) / 2\n    } else if c23 & !c12 & !c13 {\n        // Case 4: (p2, p3) aligned, p1 outlier\n        (p2 + p3) / 2\n    } else {\n        // Anything else (e.g. weird inconsistent pattern) -> reject\n        // Circuit fails -> no valid proof for this set of feeds.\n        assert(false);\n        0\n    };\n\n    (final_price, asset_id)\n}\n\n#[test]\nfn test_main() {\n    let asset_id = Field::from(1);\n    \n    // Test Case 1: All three feeds agree (within 7%)\n    let (price, id) = main(100, 105, 102, asset_id);\n    assert(price == 102); // median of [100, 102, 105]\n    assert(id == asset_id);\n    \n    // Test Case 2: p1 and p2 aligned, p3 is outlier\n    let (price2, id2) = main(100, 105, 200, asset_id);\n    assert(price2 == 102); // (100 + 105) / 2 = 102\n    assert(id2 == asset_id);\n    \n    // Test Case 3: p1 and p3 aligned, p2 is outlier\n    let (price3, id3) = main(100, 200, 105, asset_id);\n    assert(price3 == 102); // (100 + 105) / 2 = 102\n    assert(id3 == asset_id);\n    \n    // Test Case 4: p2 and p3 aligned, p1 is outlier\n    let (price4, id4) = main(200, 100, 105, asset_id);\n    assert(price4 == 102); // (100 + 105) / 2 = 102\n    assert(id4 == asset_id);\n}\n\n#[test]\nfn test_are_close() {\n    // Within 7% threshold\n    assert(are_close(100, 107));\n    assert(are_close(107, 100));\n    assert(are_close(100, 100));\n    \n    // Outside 7% threshold\n    assert(!are_close(100, 108));\n    assert(!are_close(100, 200));\n}\n\n#[test]\nfn test_sort3() {\n    let sorted = sort3(3, 1, 2);\n    assert(sorted[0] == 1);\n    assert(sorted[1] == 2);\n    assert(sorted[2] == 3);\n    \n    let sorted2 = sort3(10, 20, 5);\n    assert(sorted2[0] == 5);\n    assert(sorted2[1] == 10);\n    assert(sorted2[2] == 20);\n}\n","path":"/Users/fabiansanchezd/Documents/Neko-Oracle-RWA/src/circuits/src/main.nr"}},"expression_width":{"Bounded":{"width":4}}}